function saveScore(score) {
  const users = JSON.parse(localStorage.getItem(userKey) || '[]');
  const existing = users.find(u=>u.name===currentUser);
  if (existing) existing.score = Math.max(existing.score, score);
  else users.push({name: currentUser, score});
  localStorage.setItem(userKey, JSON.stringify(users));
}

function loadLeaderboard() {
  // reset any stale data
  if (!localStorage.getItem(userKey)) localStorage.setItem(userKey, JSON.stringify([]));

  const users = JSON.parse(localStorage.getItem(userKey) || '[]');
  users.sort((a,b)=>b.score - a.score);
  const list = document.getElementById('leaderboardList');
  if (!list) return;
  if (users.length === 0) {
    list.innerHTML = "<p>No scores yet â€” be the first to take a quiz!</p>";
    return;
  }
  list.innerHTML = users.map((u,i)=>{
    let cls = '';
    if (i===0) cls='gold';
    else if (i===1) cls='silver';
    else if (i===2) cls='bronze';
    return `<div class="leader-card ${cls}">
              <span>${i+1}. ${u.name}</span>
              <span>${u.score}</span>
            </div>`;
  }).join('');
}
